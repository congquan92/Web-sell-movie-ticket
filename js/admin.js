let ArrProduct = [
    {
      nameSP: "LEVENTS® | DORAEMON FAMOUS CAT TEE",
      img: "../img/products/p1-1.png",
      price: 370000,
      count : 3,
      nametag: "aothun#",  
      nameColor1: "XÁM",
      nameColor2: "ĐỎ",
      nameColor3:"",    
      colorr1: "gray",
      colorr2: "red",
      colorr3: "unset",
      img1: "./img/products/p1-1.png",
      img2: "./img/products/p1-2.jpg",
      img3: "./img/products/p1-2.jpg",
      sell:2
    },
    {
      nameSP: "LEVENTS® | DORAEMON COLLAB TEE",
      img: "../img/products/p2-1.png",
      price: 450000,
      count: 7,
      nametag: "aothun#",   
      nameColor1: "TRẮNG",
      nameColor2: "ĐEN",
      nameColor3:"",       
      colorr1: " rgb(235, 232, 226)",
      colorr2: "black",
      colorr3: "unset",
      img1: "./img/products/p2-1.png",
      img2: "./img/products/p2-2.png",
      img3: "./img/products/p2-2.png",
      sell :2
    },
    {
      nameSP: "LEVENTS® DINOSAUR TEE",
      img: "../img/products/p3-1.jpg",
      price: 420000,
      count: 5,
      nametag: "aothun#",  
      nameColor1: "TRẮNG",
      nameColor2: "ĐEN",
      nameColor3:"XANH DƯƠNG",        
      colorr1: " rgb(235, 232, 226)",
      colorr2: "black",
      colorr3: "blue",
      img1: "./img/products/p3-1.jpg",
      img2: "./img/products/p3-2.jpg",
      img3: "./img/products/p3-3.jpg",
      sell :7
    },
    {
      nameSP: "LEVENTS® INSIDE OUT TEE",
      img: "../img/products/p4-1.jpg",
      price: 390000,
      count: 0,
      nametag: "aothun#", 
      nameColor1: "TRẮNG",
      nameColor2: "ĐEN",
      nameColor3:"",    
      colorr1: " rgb(235, 232, 226)",
      colorr2: "black",
      colorr3: "unset",
      img1: "./img/products/p4-1.jpg",
      img2: "./img/products/p4-2.jpg",
      img3: "./img/products/p4-2.jpg",
      sell :0
    },
    {
      nameSP: "LEVENTS® LOVEYOU300K SPECIAL TEE",
      img: "../img/products/p5-1.jpg",
      price: 300000,
      count: 2,
      nametag: "aothun#",   
      nameColor1: "TRẮNG",
      nameColor2: "",
      nameColor3:"",      
      colorr1: " rgb(235, 232, 226)",
      colorr2: "unset",
      colorr3: "unset",
      img1: "./img/products/p5-1.jpg",
      img2: "./img/products/p5-1.jpg",
      img3: "./img/products/p5-1.jpg",
      sell : 0
    },
    {
      nameSP: "LEVENTS® FUNNY CROCODILE TEE",
      img: "../img/products/p6-1.jpg",
      price: 390000,
      count: 1,
      nametag: "aothun#",     
      nameColor1: "XANH DƯƠNG",
      nameColor2: "ĐEN",
      nameColor3:"",     
      colorr1: "blue",
      colorr2: "black",
      colorr3: "unset",
      img1: "./img/products/p6-1.jpg",
      img2: "./img/products/p6.jpg",
      img3: "./img/products/p6-2.jpg",
      sell : 0
    },
    {
      nameSP: "LEVENTS® PUNCH VARSITY",
      img: "../img/products/p7-1.jpg",
      price: 890000,
      count: 11,
      nametag: "aokhoac#",      
      nameColor1: "NÂU",
      nameColor2: "ĐEN",
      nameColor3:"",    
      colorr1: "brown",
      colorr2: "black",
      colorr3: "unset",
      img1: "./img/products/p7-1.jpg",
      img2: "./img/products/p7-2.jpg",
      img3: "./img/products/p7-2.jpg",
      sell : 9
    },
    {
      nameSP: "LEVENTS® SELFLOVE BOXY TEE",
      img: "../img/products/p8-1.jpg",
      price: 380000,
      count: 10,
      nametag: "aothun#",      
      nameColor1: "TRẮNG",
      nameColor2: "ĐEN",
      nameColor3:"",    
      colorr1: " rgb(235, 232, 226)",
      colorr2: "black",
      colorr3: "unset",
      img1: "./img/products/p8-1.jpg",
      img2: "./img/products/p8-2.jpg",
      img3: "./img/products/p8-1.jpg",
      sell :0
    },
    {
      nameSP: "LEVENTS® | DORAEMON MINI CAT Polo",
      img: "../img/products/p9-1.jpg",
      price: 405000,
      count: 9,
      nametag: "polo#",
      nameColor1: "TRẮNG",
      nameColor2: "ĐEN",
      nameColor3:"",    
      colorr1: " rgb(235, 232, 226)",
      colorr2: "black",
      colorr3: "unset",
      img1: "./img/products/p9-1.jpg",
      img2: "./img/products/p9-2.jpg",
      img3: "./img/products/p9-2.jpg",
      sell : 2
    },
    {
      nameSP: "LEVENTS® MINI POPULAR Polo",
      img: "../img/products/p10-1.jpg",
      price: 370000,
      count: 6,
      nametag: "polo#",
      nameColor1: "TRẮNG",
      nameColor2: "ĐEN",
      nameColor3:"",     
      colorr1: " rgb(235, 232, 226)",
      colorr2: "black",
      colorr3: "unset",
      img1: "./img/products/p10-1.jpg",
      img2: "./img/products/p10-2.jpg",
      img3: "./img/products/p10-2.jpg",
      sell : 8
    },
    {
      nameSP: "LEVENTS® STRIPE Polo",
      img: "../img/products/p11-1.jpg",
      price: 420000,
      count: 2,
      nametag: "polo#", 
      nameColor1: "TRẮNG",
      nameColor2: "ĐEN",
      nameColor3:"",    
      colorr1: " rgb(235, 232, 226)",
      colorr2: "black",
      colorr3: "unset",
      img1: "./img/products/p11-1.jpg",
      img2: "./img/products/p11-2.jpg",
      img3: "./img/products/p11-2.jpg",
      sell : 2
    },
    {
      nameSP: "LEVENTS® CINEMA SHIRT",
      img: "../img/products/p12-1.jpg",
      price: 420000,
      count: 3,
      nametag: "somi#",
      nameColor1: "NÂU",
      nameColor2: "ĐEN",
      nameColor3:"",     
      colorr1: "brown",
      colorr2: "black",
      colorr3: "unset",
      img1: "./img/products/p12-1.jpg",
      img2: "./img/products/p12-2.jpg",
      img3: "./img/products/p12-2.jpg",
      sell : 5
    },
    {
      nameSP: "LEVENTS® CITIES SHIRT",
      img: "../img/products/p13-1.jpg",
      price: 420000,
      count: 8,
      nametag: "somi#",
      nameColor1: "TRẮNG",
      nameColor2: "ĐEN",
      nameColor3:"",     
      colorr1: " rgb(235, 232, 226)",
      colorr2: "black",
      colorr3: "unset",
      img1: "./img/products/p13-1.jpg",
      img2: "./img/products/p13-2.jpg",
      img3: "./img/products/p13-2.jpg",
      sell : 6
    },
    {
      nameSP: "LEVENTS® | DORAEMON COLLAB ZIPPER Hoodie",
      img: "../img/products/p14-1.jpg",
      price: 645000,
      count: 5,
      nametag: "hoodie#",
      nameColor1: "TRẮNG",
      nameColor2: "XÁM",
      nameColor3:"",    
      colorr1: " rgb(235, 232, 226)",
      colorr2: "gray",
      colorr3: "unset",
      img1: "./img/products/p14-1.jpg",
      img2: "./img/products/p14-2.jpg",
      img3: "./img/products/p14-2.jpg",
      sell : 2
    },
    {
      nameSP: "LEVENTS® POPULAR LOGO 2.0 Hoodie",
      img: "../img/products/p15-1.jpg",
      price: 590000,
      count: 4,
      nametag: "hoodie#",
      nameColor1: "VÀNG",
      nameColor2: "XÁM",
      nameColor3:"ĐEN",    
      colorr1: "yellow",
      colorr2: "gray",
      colorr3: "black",
      img1: "./img/products/p15-1.jpg",
      img2: "./img/products/p15-2.jpg",
      img3: "./img/products/p15-3.jpg",
      sell : 7
    },
    {
      nameSP: "LEVENTS® MINI LOGO ZIPPER Hoodie",
      img: "../img/products/p16-1.jpg",
      price: 620000,
      count: 2,
      nametag: "hoodie#",
      nameColor1: "TRẮNG",
      nameColor2: "XÁM",
      nameColor3:"",    
      colorr1: " rgb(235, 232, 226)",
      colorr2: "gray",
      colorr3: "unset",
      img1: "./img/products/p16-1.jpg",
      img2: "./img/products/p16-2.jpg",
      img3: "./img/products/p16-2.jpg",
      sell : 2
    },
    {
      nameSP: "LEVENTS® | DORAEMON COLLAB Hoodie",
      img: "../img/products/p17-1.jpg",
      price: 620000,
      count: 9,
      nametag: "hoodie#",
      nameColor1: "TRẮNG",
      nameColor2: "ĐEN",
      nameColor3:"",    
      colorr1: " rgb(235, 232, 226)",
      colorr2: "black",
      colorr3: "unset",
      img1: "./img/products/p17-1.jpg",
      img2: "./img/products/p17-2.jpg",
      img3: "./img/products/p17-2.jpg",
      sell : 1
    },
    {
      nameSP: "LEVENTS® BASIC Sweater",
      img: "../img/products/p18-1.jpg",
      price: 490000,
      count: 6,
      nametag: "sweater#",
      nameColor1: "XÁM",
      nameColor2: "ĐỎ",
      nameColor3:"",    
      colorr1: "gray",
      colorr2: "red",
      colorr3: "unset",
      img1: "./img/products/p18-1.jpg",
      img2: "./img/products/p18-2.jpg",
      img3: "./img/products/p18-2.jpg",
      sell : 9
    },
    {
      nameSP: "LEVENTS® FUNNY CROCODILE Sweater",
      img: "../img/products/p19-1.jpg",
      price: 490000,
      count: 12,
      nametag: "sweater#",
      nameColor1: "NÂU",
      nameColor2: "ĐEN",
      nameColor3:"",    
      colorr1: "brown",
      colorr2: "black",
      colorr3: "unset",
      img1: "./img/products/p19-1.jpg",
      img2: "./img/products/p19-2.jpg",
      img3: "./img/products/p19-2.jpg",
      sell : 3
    },
  ];
let typeproducts = [
    { typeid: "aothun#", typename: "Áo thun" },
    { typeid: "polo#", typename: "Polo" },
    { typeid: "somi#", typename: "Sơ mi" },
    { typeid: "hoodie#", typename: "Hoodie" },
    { typeid: "sweater#", typename: "Sweater" },
    { typeid: "aokhoac#", typename: "Áo khoác" },
  ];

// Hàm tạo id SP
function makeIDproduct() {
  for (let i = 0; i < ArrProduct.length; i++) {
    ArrProduct[i].idproduct = ArrProduct[i].nametag + (i + 1);
  }
}
//----------------sp-------------------------
// Hàm xác định trạng thái sản phẩm
function productSatus() {
  ArrProduct.forEach(i => {
    let status = 'C.XÁC ĐỊNH';
    let colorStatus = '#000';
    if (i.count > 10) {
      status = 'CÒN HÀNG';
      colorStatus = '#32CD32';
    } else if (i.count == 0) {
      status = 'HẾT HÀNG';
      colorStatus = '#EE4B2B';
    } else if (i.count <= 10) {
      status = 'SẮP HẾT';
      colorStatus = '#FDDA0D';
    }
    i.status = status;
    i.colorStatus = colorStatus;
  });
}

// Hàm tạo danh sách sản phẩm
function listSP(arr) {
  let s = '';
  makeIDproduct();
  productSatus();
  arr.forEach(product => {
    const Price = (product.price).toLocaleString("vi-VN", {style: "currency",currency: "VND",});
    s += `
            <div class="list">
                <span style="width: 10%" class="idProduct">${product.idproduct}</span>
                <img style="width: 20%" src="${product.img}" class="imgProduct" alt="Ảnh">
                <span style="width: 30%" class="nameProduct">${product.nameSP}</span>
                <span style="width: 10%" class="colorProduct">${product.nameColor1}</span>
                <span style="width: 10%" class="countProduct">${product.count}</span>
                <span style="width: 10%" class="priceProduct">${Price}</span>
                <span style="width: 10%; color: ${product.colorStatus}" class="statusProduct" style="color:${product.colorStatus}">${product.status}</span>
            </div>
    `;
  });
  return s;
}
// Hàm đếm số lượng sản phẩm
function countProduct(arr) {
  return arr.length;
}
// Hàm tìm kiếm sản phẩm
function searchSP(){
  const comboType = document.getElementById('comboType').value;
  const comboStatus = document.getElementById('comboStatus').value;
  let filteredProducts = ArrProduct;
  if (comboType !== "0") {
    filteredProducts = filteredProducts.filter(product => product.nametag === comboType);
  }
  if (comboStatus !== "0") {
    filteredProducts = filteredProducts.filter(product => {
      if (comboStatus === "1") return product.status === "CÒN HÀNG";
      if (comboStatus === "2") return product.status === "SẮP HẾT";
      if (comboStatus === "3") return product.status === "HẾT HÀNG";
    });
  }
  document.querySelector('#storage-body').innerHTML= listSP(filteredProducts);
  document.querySelector('#amountOfProduct').innerText= countProduct(filteredProducts);
}
// Hàm render quản lý san pham
function renderqlsp(){
  document.querySelector('.page-right').innerHTML =  
            `<div class="qlsp">
                <div class="title"><h1>QUẢN LÝ SẢN PHẨM</h1></div>
                <div class="btnAdd"><div class="circle"><i class="fa-solid fa-plus"></i></div></div>
                <div class="groupOption">
                        <select name="" class="box" id="comboType" onchange="searchSP()" >
                            <option value="0">Tất cả</option>
                            <option value="aothun#">Áo thun</option>
                            <option value="polo#">Polo</option>
                            <option value="somi#">Sơ mi</option>
                            <option value="hoodie#">Hoodie</option>
                            <option value="sweater#">Sweater</option>
                            <option value="aokhoac#">Áo khoác</option>
                        </select>
                        <select name="" class="box" id="comboStatus" onchange="searchSP()" >
                            <option value="0">Tất cả</option>
                            <option value="1">CÒN HÀNG</option>
                            <option value="2">SẮP HẾT</option>
                            <option value="3">HẾT HÀNG</option>
                        </select>
                        <div class="box">
                            <div class="contentBox">
                                <div class="leftBox">
                                    <h2 id="amountOfProduct">0</h2>
                                    <span>SẢN PHẨM</span>
                                </div>
                                <i class="fa-solid fa-star"></i>
                            </div>
                        </div>
                </div>
                <div class="titleCol">
                    <span style="width: 10%" class="idProduct">ID</span>
                    <span style="width: 20% ; padding-left: 7%" class="imgProduct">Hình ảnh</span>
                    <span style="width: 30% ; padding-left: 5%" class="nameProduct">Tên sản phẩm</span>
                    <span style="width: 10%" class="colorProduct">Màu sắc</span>
                    <span style="width: 10%" class="countProduct">Số lượng</span>
                    <span style="width: 10%" class="priceProduct">Đơn giá</span>
                    <span style="width: 10%" class="statusProduct">Trạng thái</span>
                </div>
                <div id="storage-body"></div>`;
                searchSP();   
}
// ---------------------------------------------------------------------------------
// tk
// Hàm tạo biểu đồ
const listSweater = ArrProduct.filter(i => i.nametag === 'sweater#');
const listSomi = ArrProduct.filter(i => i.nametag === 'somi#');
const listHoodie = ArrProduct.filter(i => i.nametag === 'hoodie#');
const listAokhoac = ArrProduct.filter(i => i.nametag === 'aokhoac#');
const listAothun = ArrProduct.filter(i => i.nametag === 'aothun#');

const namee = ['Áo khoác', 'Sweater', 'Hoodie', 'Áo thun', 'Sơ mi'];
const sumList = [
    listAokhoac.reduce((i, x) => i + x.sell, 0),
    listSweater.reduce((i, x) => i + x.sell, 0),
    listHoodie.reduce((i, x) => i + x.sell, 0),
    listAothun.reduce((i, x) => i + x.sell, 0),
    listSomi.reduce((i, x) => i + x.sell, 0),
];
//tao bieu do
function createChart() {
  const ctx = document.getElementById('grapbox').getContext('2d');
  const chartData = {
    labels: namee ,
    datasets: [{
      label: 'Sales Data',
      data: sumList ,
      backgroundColor: [
        'rgb(255, 99, 132)',
        'rgb(75, 192, 192)',
        'rgb(255, 205, 86)',
        'rgb(201, 203, 207)',
        'rgb(54, 162, 235)'
      ]
    }]
  };
  new Chart(ctx, {
    type: 'polarArea',
    data: chartData,
    options: {}
  });
}
// Hàm render quản lý thống kê
function renderqltk(){
  document.querySelector('.page-right').innerHTML =`<div class = qltk>
  <h1>SỐ LIỆU THỐNG KÊ</h1>
  <div class="overview">
      <div class="chart ff"><canvas style="display: block; box-sizing: border-box;" id="grapbox" width="541px" height="541px" ></canvas></div>
      <div class="ll">
         <div class="boder first">
          <h1>Thống kê</h1>    
         </div> 
         <div class="boder">
              <div class="left-boder">
                  <h2 style="color: blue;">${sumList.reduce((i,n) => i+n,0)}</h2>
                  <h2 style="font-weight: 200;">ĐÃ BÁN</h2> 
              </div>
              <div class="right-boder"><i style="font-size: 40px;font-weight: 200;" class='bx bx-cart-alt'></i></div>   
         </div> 
         <div class="boder">
              <div class="left-boder">
                  <h2 style="color: blue;">${(ArrProduct.reduce((i,n) => i+((n.sell)*(n.price)),0)).toLocaleString("vi-VN", {style: "currency",currency: "VND",})}</h2>
                  <h2 style="font-weight: 200;">DOANH THU</h2>
              </div>
              <div class="right-boder"><i style="font-size: 40px;font-weight: 200;" class='bx bx-money-withdraw'></i></div>   
         </div> 
      </div>
   </div>
</div>
<div class="rankProfit">
  <div style="margin-top: 0px; position:unset; " class="titleCol">
        <span style="width: 30%;" class="name">TÊN SẢN PHẨM</span>
        <span style="width: 30%;" class="sold">Đã bán</span>
        <span style="width: 10%; float: right" class="profits">DOANH THU</span>
    </div>
    <div id="rankProfit-body"></div>
</div>`
createChart(); // Tạo biểu đồ khi nhấp vào "QUẢN LÝ THỐNG KÊ"
rankProfit();
}
//ham tao doanh thu
function rankProfit(){
  let s='';
  const sortArrsell=[...ArrProduct].sort((a,b) => (b.sell*b.price)-(a.sell*a.price));
  sortArrsell.forEach(i=>{
    s+=` <div class="rankProfit-Child">
            <span style="width: 30%;" class="name">${i.nameSP}</span>
            <span style="width: 30%;" class="sold">${i.sell}</span>
            <span style="width: 10%;  class="profits">${(i.price *i.sell).toLocaleString("vi-VN", {style: "currency",currency: "VND",})}</span>
           </div>`
  })
  document.getElementById('rankProfit-body').innerHTML=s;
}

// Gọi hàm renderqltk khi trang tải
window.onload = () => {
  renderqltk();
};
// -------------------------------------------------------------------
document.addEventListener("DOMContentLoaded", () => {
    const QLTK = document.querySelector('.b1');
    const QLDH = document.querySelector('.b2');
    const QLSP = document.querySelector('.b3');
    const QLND = document.querySelector('.b4');
    
    QLTK.addEventListener('click', () => {
      QLTK.classList.add('act');
      QLDH.classList.remove('act');
      QLSP.classList.remove('act');
      QLND.classList.remove('act');
      renderqltk();
    });
  
    QLDH.addEventListener('click', () => {
      QLTK.classList.remove('act');
      QLDH.classList.add('act');
      QLSP.classList.remove('act');
      QLND.classList.remove('act');
    });
    
    //sp
    QLSP.addEventListener('click', () => {
      QLTK.classList.remove('act');
      QLDH.classList.remove('act');
      QLSP.classList.add('act');
      QLND.classList.remove('act');
      renderqlsp();

    });

    QLND.addEventListener('click', () => {
        QLTK.classList.remove('act');
        QLDH.classList.remove('act');
        QLSP.classList.remove('act');
        QLND.classList.add('act');
      });
    
  });

